# 多关卡系统设计文档

## 概述

参考优秀益智游戏的设计理念，为每个游戏类型增加了多个关卡，实现渐进式难度提升和完整的进度追踪系统。

## 设计理念

### 1. 渐进式难度曲线
- **简单 → 中等 → 困难 → 专家**：每个游戏都有6个关卡，难度逐步提升
- **参数化配置**：每个关卡都有独立的配置参数，可以精确控制难度
- **多维度难度**：速度、数量、精度、时间限制等多个维度组合

### 2. 关卡解锁机制
- **顺序解锁**：完成前一关才能解锁下一关
- **星级评价**：每关都有1-3星评价，鼓励重复挑战
- **进度保存**：使用 localStorage 持久化保存进度

### 3. 星级评价系统
- **3星**：完美表现（高分+高准确率+快速完成）
- **2星**：优秀表现（中等分数+中等准确率）
- **1星**：基础完成（完成关卡即可）

## 关卡配置

### 色彩大作战（6关）

| 关卡 | 名称 | 难度 | 特点 |
|------|------|------|------|
| 1 | 初识颜色 | 简单 | 2种颜色，慢速，5生命 |
| 2 | 三色挑战 | 简单 | 3种颜色，速度提升 |
| 3 | 四色大师 | 中等 | 4种颜色，更快速度 |
| 4 | 速度挑战 | 中等 | 时间限制，高速度 |
| 5 | 精准大师 | 困难 | 小气球，高准确率要求 |
| 6 | 极限挑战 | 专家 | 最快速度，最高难度 |

**难度参数变化**：
- 生成间隔：3000ms → 800ms
- 气球速度：1.5 → 5.0
- 气球大小：50-60px → 25-35px
- 颜色种类：2种 → 4种
- 生命值：5 → 1
- 目标数量：10 → 40

### 障碍躲避（6关）

| 关卡 | 名称 | 难度 | 特点 |
|------|------|------|------|
| 1 | 基础躲避 | 简单 | 仅低障碍，直线移动 |
| 2 | 高低组合 | 简单 | 增加高障碍，需要深蹲 |
| 3 | 速度提升 | 中等 | 障碍更快，数量增加 |
| 4 | 移动障碍 | 中等 | 障碍左右移动 |
| 5 | 密集挑战 | 困难 | 更多障碍，更高速度 |
| 6 | 终极考验 | 专家 | 最快速度，最多障碍 |

**难度参数变化**：
- 障碍速度：2.0 → 6.0
- 生成间隔：2000ms → 800ms
- 同时障碍数：1 → 5
- 移动模式：直线 → 之字形
- 目标时间：30秒 → 120秒

### 姿势临摹（6关）

| 关卡 | 名称 | 难度 | 特点 |
|------|------|------|------|
| 1 | 简单姿势 | 简单 | 基础姿势，宽松匹配 |
| 2 | 标准姿势 | 简单 | 中等难度姿势 |
| 3 | 复杂姿势 | 中等 | 高难度姿势，需要精确 |
| 4 | 快速模仿 | 中等 | 时间限制，快速反应 |
| 5 | 精准大师 | 困难 | 极高精度要求 |
| 6 | 终极挑战 | 专家 | 最高难度，完美匹配 |

**难度参数变化**：
- 匹配阈值：70% → 90%
- 姿势复杂度：简单 → 专家
- 姿势数量：3 → 12
- 时间限制：无 → 100秒

## 星级评价标准

### 色彩大作战
- **3星**：高分 + 准确率 ≥ 90%
- **2星**：中等分数 + 准确率 ≥ 70%
- **1星**：基础分数 + 准确率 ≥ 50%

### 障碍躲避
- **3星**：存活时间达标 + 高分
- **2星**：中等时间 + 中等分数
- **1星**：基础时间

### 姿势临摹
- **3星**：准确率 ≥ 90% + 快速完成
- **2星**：准确率 ≥ 80% + 中等速度
- **1星**：准确率 ≥ 65%

## 技术实现

### 1. 关卡配置系统 (`src/config/levelConfig.js`)
- 集中管理所有关卡配置
- 提供关卡查询和星级计算函数
- 支持动态难度调整

### 2. 游戏状态管理 (`src/stores/game.js`)
- `currentLevel`：游戏类型（1/2/3）
- `currentSubLevel`：子关卡编号（1-6）
- `levelProgress`：关卡进度和星级
- `totalStars`：总星级统计

### 3. 关卡选择界面 (`src/components/LevelSelect.vue`)
- 两级选择：游戏类型 → 子关卡
- 显示解锁状态和星级
- 显示关卡难度和描述

### 4. 关卡完成界面 (`src/components/GameOver.vue`)
- 星级动画展示
- 详细数据统计
- 成就系统
- 下一关解锁提示

## 用户体验优化

### 1. 视觉反馈
- ⭐ 星级动画效果
- 🔒 锁定状态清晰显示
- ✅ 完成关卡高亮显示
- 📊 进度统计可视化

### 2. 激励机制
- 星级评价鼓励重复挑战
- 成就系统增加趣味性
- 总星级统计提供长期目标
- 关卡解锁提供成就感

### 3. 难度平衡
- 第一关总是解锁，降低门槛
- 难度曲线平滑，避免挫败感
- 多维度评价，不同玩家都能获得成就感
- 时间限制可选，适应不同节奏

## 数据持久化

### localStorage 结构
```javascript
{
  "motion-games-progress": {
    "color-1": { stars: 2, unlocked: true },
    "color-2": { stars: 3, unlocked: true },
    "obstacle-1": { stars: 1, unlocked: true },
    // ...
  }
}
```

### 进度同步
- 自动保存：完成关卡时自动保存
- 自动加载：应用启动时自动加载
- 跨会话：关闭浏览器后进度保留

## 扩展性

### 添加新关卡
1. 在 `levelConfig.js` 中添加关卡配置
2. 设置 `unlocked: false`（自动解锁）
3. 配置难度参数和星级标准

### 添加新游戏类型
1. 创建新的关卡配置数组
2. 在 `getLevelsByGameType` 中添加映射
3. 创建对应的关卡组件
4. 在 `LevelSelect` 中添加游戏类型

### 自定义难度
- 修改 `DIFFICULTY_CONFIG` 调整难度标签
- 修改关卡配置中的参数
- 调整星级评价标准

## 最佳实践

### 难度设计
1. **渐进式**：每关难度提升不超过20%
2. **多维度**：不要只增加速度，也要调整其他参数
3. **可完成性**：确保普通玩家能完成至少1星
4. **挑战性**：3星应该有挑战性，但不是不可能

### 用户体验
1. **清晰反馈**：明确告知玩家当前进度和目标
2. **即时奖励**：完成关卡立即显示星级
3. **鼓励重复**：允许重复挑战提升星级
4. **避免挫败**：失败时提供鼓励和提示

## 未来扩展

- [ ] 每日挑战模式
- [ ] 排行榜系统
- [ ] 特殊奖励关卡
- [ ] 自定义关卡编辑器
- [ ] 多人对战模式
- [ ] 成就系统扩展
- [ ] 数据分析面板

---

**设计参考**：
- 《糖果传奇》的关卡解锁机制
- 《愤怒的小鸟》的星级评价系统
- 《纪念碑谷》的渐进式难度设计
- 《植物大战僵尸》的多维度难度平衡
